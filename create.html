<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=390, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>生成白噪声</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    .status-bar { height:44px; background:#fff; display:flex; justify-content:space-between; align-items:center; padding:0 20px; font-size:14px; color:#222; border-bottom:1px solid #f0f0f0;}
    .tab-bar { height:83px; background:#fff; border-top:1px solid #f0f0f0; display:flex; justify-content:space-around; align-items:center; position:absolute; bottom:0; left:0; right:0;}
    .tab-item { display:flex; flex-direction:column; align-items:center; color:#888; font-size:12px;}
    .tab-item.active { color:#222;}
    .tab-item i { font-size:22px; margin-bottom:2px;}
    .audio-wave { display:flex; align-items:flex-end; height:32px; gap:2px;}
    .wave-bar { width:4px; background:#a3bffa; border-radius:2px; animation:wave 1.2s infinite ease-in-out;}
    .wave-bar:nth-child(2) { animation-delay:0.2s;}
    .wave-bar:nth-child(3) { animation-delay:0.4s;}
    .wave-bar:nth-child(4) { animation-delay:0.6s;}
    .wave-bar:nth-child(5) { animation-delay:0.8s;}
    @keyframes wave { 0%,100%{height:8px;} 50%{height:28px;} }
    /* Switch美化 */
    .switch { position: relative; display: inline-block; width: 40px; height: 22px; }
    .switch input { opacity: 0; width: 0; height: 0; }
    .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #e5e7eb; transition: .4s; border-radius: 9999px; }
    .slider:before { position: absolute; content: ""; height: 18px; width: 18px; left: 2px; bottom: 2px; background-color: white; transition: .4s; border-radius: 50%; box-shadow: 0 1px 4px rgba(0,0,0,0.08); }
    input:checked + .slider { background-color: #3b82f6; }
    input:checked + .slider:before { transform: translateX(18px); }
    /* 单选按钮组美化（修正版） */
    .radio-group label {
      cursor:pointer;
      padding: 0.36rem 1.1rem;
      border-radius: 22px;
      border: 1.5px solid #e5e7eb;
      margin-right: 0.5rem;
      font-size: 0.97rem;
      transition: all 0.2s;
      background: #f9fafb;
      color: #374151;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 500;
      position: relative;
      min-width: 62px;
      white-space: nowrap;
      max-width: 120px;
      text-overflow: ellipsis;
      overflow: hidden;
      vertical-align: middle;
    }
    .radio-group input[type="radio"] {
      display: none;
    }
    .radio-group input[type="radio"]:checked + span,
    .radio-group label.selected {
      background: #3b82f6 !important;
      color: #fff !important;
      border-color: #3b82f6 !important;
      box-shadow: 0 2px 8px 0 rgba(59,130,246,0.08);
    }
    .radio-group label span {
      display: block;
      width: 100%;
      text-align: center;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      line-height: 1.2;
    }
    /* 自定义输入框美化 */
    .bpm-custom-wrap {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-left: 1.2rem;
      height: 2.3em;
    }
    .bpm-custom-label {
      font-size: 0.95rem;
      color: #64748b;
      margin-right: 0.2rem;
      white-space: nowrap;
    }
    .bpm-custom-input {
      border-radius: 22px;
      border: 1.5px solid #3b82f6;
      padding: 0.36rem 1.1rem;
      width: 70px;
      font-size: 0.97rem;
      outline: none;
      box-shadow: 0 1px 4px 0 rgba(59,130,246,0.07);
      transition: border 0.2s;
      height: 2.3em;
    }
    .bpm-custom-input:focus {
      border-color: #2563eb;
    }
    .bpm-custom-input::placeholder {
      color: #b6c3d1;
      font-size: 0.95rem;
    }
    /* 主音轨Switch对齐优化 */
    .main-track-row {
      display: flex;
      align-items: center;
      justify-content: flex-start;
      gap: 0.3rem;
      height: 30px;
      margin-top: 0.2rem;
    }
    .main-track-label {
      font-size: 0.95rem;
      color: #2563eb;
      font-weight: 600;
      letter-spacing: 0.02em;
      margin-bottom: 0;
    }
    /* 卡片和全局区进一步美化 */
    .track-card {
      border-radius: 1.5rem;
      box-shadow: 0 6px 32px 0 rgba(59,130,246,0.10);
      border: 1.5px solid #e0e7ff;
      margin-bottom: 1.1rem;
      background: linear-gradient(135deg, #f8fafc 80%, #e0e7ff 100%);
      padding: 1.1rem 1rem 1rem 1rem;
    }
    .track-card .track-header {
      border-bottom: 1px solid #e0e7ff;
      margin-bottom: 0.5rem;
      padding-bottom: 0.3rem;
    }
    .track-card .track-title {
      font-weight: 700;
      font-size: 1.08rem;
      color: #1e293b;
    }
    .track-card .delete-btn {
      color: #ef4444;
      font-size: 1rem;
      border-radius: 9999px;
      padding: 0.1rem 0.6rem;
      background: #fef2f2;
      transition: background 0.2s;
    }
    .track-card .delete-btn:hover {
      background: #fee2e2;
    }
    .track-card .track-controls { gap: 1.1rem; }
    .track-card .track-controls > div { min-width: 110px; }
    .global-section-title {
      font-weight: 700;
      font-size: 1rem;
      margin-bottom: 0.3rem;
      color: #2563eb;
      letter-spacing: 0.01em;
    }
    .global-section {
      margin-bottom: 1rem;
    }
    .bg-white.rounded-2xl.shadow.p-6.mb-6.border.border-blue-100 {
      background: linear-gradient(135deg, #f8fafc 80%, #e0e7ff 100%);
      border-radius: 1.5rem;
      border: 1.5px solid #e0e7ff;
      box-shadow: 0 6px 32px 0 rgba(59,130,246,0.10);
      padding: 1.1rem 1rem 1rem 1rem !important;
      margin-bottom: 1.1rem !important;
    }
    /* 操作按钮优化 */
    .main-action-btn {
      border-radius: 9999px;
      font-size: 1.05rem;
      font-weight: 600;
      padding: 0.6rem 0;
      box-shadow: 0 2px 8px 0 rgba(59,130,246,0.08);
      transition: background 0.2s, color 0.2s;
    }
    .main-action-btn.bg-blue-500:hover { background: #2563eb; }
    .main-action-btn.bg-gray-200:hover { background: #e5e7eb; }
    .main-action-btn.bg-green-500:hover { background: #059669; }
    .main-action-btn.bg-red-100:hover { background: #fecaca; color: #b91c1c; }
    /* 超酷炫生成按钮 */
    .generate-btn {
      width: 100%;
      padding: 1.2rem 2rem;
      border-radius: 25px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #f5576c 75%, #4facfe 100%);
      background-size: 300% 300%;
      border: none;
      color: white;
      font-size: 1.3rem;
      font-weight: 700;
      letter-spacing: 0.05em;
      cursor: pointer;
      position: relative;
      overflow: hidden;
      box-shadow: 0 8px 32px rgba(102, 126, 234, 0.4), 0 0 0 1px rgba(255, 255, 255, 0.1);
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    }
    .generate-btn:hover {
      transform: translateY(-3px) scale(1.02);
      box-shadow: 0 12px 40px rgba(102, 126, 234, 0.6), 0 0 0 2px rgba(255, 255, 255, 0.2);
      background-position: 100% 100%;
    }
    .generate-btn:active {
      transform: translateY(-1px) scale(0.98);
    }
    .generate-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.5s;
    }
    .generate-btn:hover::before {
      left: 100%;
    }
    .generate-btn .icon {
      display: inline-block;
      margin-right: 0.8rem;
      font-size: 1.4rem;
      animation: pulse 2s infinite;
    }
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }
    .generate-btn:hover .icon {
      animation: spin 1s linear infinite;
    }
    @keyframes spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    .generate-btn .text {
      display: inline-block;
      position: relative;
      z-index: 1;
    }
    /* 横向tab栏美化 */
    #track-tabs {
      scrollbar-width: none;
      -ms-overflow-style: none;
    }
    #track-tabs::-webkit-scrollbar {
      display: none;
    }
    .track-tab {
      min-width: 90px;
      padding: 0.5rem 1.5rem 0.5rem 1.1rem;
      border-radius: 9999px;
      background: linear-gradient(90deg, #a5b4fc 0%, #60a5fa 100%);
      color: #fff;
      font-weight: 600;
      font-size: 1rem;
      border: 2px solid #3b82f6;
      cursor: pointer;
      transition: all 0.2s;
      white-space: nowrap;
      box-shadow: 0 2px 8px 0 rgba(59,130,246,0.10);
      display: flex;
      align-items: center;
      gap: 0.5em;
      position: relative;
    }
    .track-tab .fa-music {
      font-size: 1.1em;
      margin-right: 0.2em;
    }
    .track-tab.active {
      background: linear-gradient(90deg, #6366f1 0%, #3b82f6 100%);
      color: #fff;
      border-color: #6366f1;
      box-shadow: 0 4px 16px 0 rgba(99,102,241,0.18), 0 0 0 2px rgba(99,102,241,0.1);
      z-index: 1;
      transform: translateY(-1px);
    }
    .track-tab:not(.active):hover {
      background: #e0e7ff;
      color: #3b82f6;
      border-color: #a5b4fc;
    }
    /* 音轨卡片与tab的视觉关联 */
    .track-card {
      border-radius: 1.5rem;
      box-shadow: 0 6px 32px 0 rgba(59,130,246,0.10);
      border: 1.5px solid #e0e7ff;
      margin-bottom: 1.1rem;
      background: linear-gradient(135deg, #f8fafc 80%, #e0e7ff 100%);
      padding: 1.1rem 1rem 1rem 1rem;
      transition: all 0.3s ease;
      position: relative;
    }
    .track-card::before {
      content: '';
      position: absolute;
      top: -8px;
      left: var(--arrow-left, 50%);
      width: 0;
      height: 0;
      border-left: 8px solid transparent;
      border-right: 8px solid transparent;
      border-bottom: 8px solid #e0e7ff;
      opacity: 0;
      transition: left 0.3s ease, opacity 0.3s ease;
      transform: translateX(-50%);
    }
    .track-card.active {
      border-color: #6366f1;
      box-shadow: 0 6px 32px 0 rgba(99,102,241,0.15), 0 0 0 2px rgba(99,102,241,0.1);
      background: linear-gradient(135deg, #f8fafc 80%, #e0e7ff 100%);
    }
    .track-card.active::before {
      opacity: 1;
      border-bottom-color: #6366f1;
    }
    /* tab切换动画 */
    #track-tabs {
      scrollbar-width: none;
      -ms-overflow-style: none;
      position: relative;
    }
    #track-tabs::after {
      content: '';
      position: absolute;
      bottom: -4px;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, #e0e7ff 0%, #a5b4fc 50%, #e0e7ff 100%);
      border-radius: 1px;
    }
    .hide-scrollbar {
      scrollbar-width: none;
      -ms-overflow-style: none;
    }
    .hide-scrollbar::-webkit-scrollbar {
      display: none;
    }
    /* 统一播放按钮高度、圆角、字体 */
    .play-btn {
      border-radius: 22px !important;
      padding: 0.36rem 1.1rem !important;
      font-size: 0.97rem !important;
      height: 2.3em;
      display: flex;
      align-items: center;
      gap: 0.5em;
      box-shadow: 0 2px 8px 0 rgba(59,130,246,0.10);
    }
  </style>
</head>
<body class="bg-[#f8f8f8] text-gray-900 h-full relative">
  <!-- 状态栏 -->
  <div class="status-bar" style="position: fixed; top: 0; left: 0; right: 0; z-index: 1000;">
    <span>9:41</span>
    <div>
      <i class="fas fa-signal mr-2"></i>
      <i class="fas fa-wifi mr-2"></i>
      <i class="fas fa-battery-full"></i>
    </div>
  </div>
  <!-- 内容 -->
  <div class="pt-14 pb-24 px-5">
    <h2 class="text-xl font-bold mb-4">生成白噪声</h2>
    <!-- 录音/导入/素材箱 -->
    <div class="flex gap-4 mb-6">
      <button class="flex-1 bg-white rounded-xl shadow px-4 py-3 flex flex-col items-center">
        <i class="fas fa-microphone text-blue-500 text-2xl mb-1"></i>
        <span class="text-xs text-gray-700">录音</span>
      </button>
      <button class="flex-1 bg-white rounded-xl shadow px-4 py-3 flex flex-col items-center">
        <i class="fas fa-upload text-green-500 text-2xl mb-1"></i>
        <span class="text-xs text-gray-700">导入</span>
      </button>
      <button class="flex-1 bg-white rounded-xl shadow px-4 py-3 flex flex-col items-center">
        <i class="fas fa-box-open text-yellow-500 text-2xl mb-1"></i>
        <span class="text-xs text-gray-700">草稿箱</span>
      </button>
    </div>
    <!-- 音轨tab栏 -->
    <div id="track-tabs" class="flex overflow-x-auto gap-3 mb-4 pb-2 hide-scrollbar">
      <!-- JS生成tab -->
    </div>
    <!-- 音轨卡片区 -->
    <div id="track-list" class="mb-6">
      <!-- JS生成音轨卡片 -->
    </div>
    <!-- 全局调控区 -->
    <div class="bg-white rounded-2xl shadow p-6 mb-6 border border-blue-100">
      <div class="global-section mb-4">
        <div class="global-section-title">节拍(BPM)</div>
        <div class="flex items-center gap-3 radio-group">
          <label><input type="radio" name="bpm" value="auto" checked><span>智能</span></label>
          <div class="bpm-custom-wrap">
            <span class="bpm-custom-label">自定义</span>
            <input type="number" min="1" max="300" class="bpm-custom-input" placeholder="数值">
          </div>
        </div>
      </div>
      <div class="global-section mb-4">
        <div class="global-section-title">场景</div>
        <div class="flex gap-3 radio-group">
          <label><input type="radio" name="scene" value="sleep" checked><span>助眠</span></label>
          <label><input type="radio" name="scene" value="study"><span>学习</span></label>
          <label><input type="radio" name="scene" value="meditate"><span>冥想</span></label>
        </div>
      </div>
      <div class="global-section">
        <div class="global-section-title">疗愈分类</div>
        <div class="flex gap-3 radio-group">
          <label><input type="radio" name="category" value="white" checked><span>白噪音</span></label>
          <label><input type="radio" name="category" value="asmr"><span>ASMR</span></label>
        </div>
      </div>
    </div>
    <!-- 操作按钮（试听/保存/发布/删除）和底部导航栏保持不变 -->
    <!-- 超酷炫生成按钮 -->
    <div class="mb-6">
      <button class="generate-btn">
        <i class="fas fa-magic icon"></i>
        <span class="text">生成</span>
      </button>
    </div>
  </div>
  <!-- 底部导航栏 -->
  <div class="tab-bar" style="position: fixed; bottom: 0; left: 0; right: 0; z-index: 1000;">
    <div class="tab-item active">
      <i class="fas fa-plus-circle"></i>
      <span>生成</span>
    </div>
    <div class="tab-item">
      <i class="fas fa-compass"></i>
      <span>社区</span>
    </div>
    <div class="tab-item">
      <i class="fas fa-play-circle"></i>
      <span>播放</span>
    </div>
    <div class="tab-item">
      <i class="fas fa-user"></i>
      <span>我的</span>
    </div>
  </div>
</body>
<script>
// 选中高亮修复：为所有 radio-group 自动加 selected 类
function updateRadioGroupHighlight() {
  document.querySelectorAll('.radio-group').forEach(group => {
    group.querySelectorAll('label').forEach(label => {
      const input = label.querySelector('input[type="radio"]');
      if (input && input.checked) {
        label.classList.add('selected');
      } else {
        label.classList.remove('selected');
      }
    });
  });
}
document.addEventListener('change', function(e) {
  if (e.target.matches('.radio-group input[type="radio"]')) {
    updateRadioGroupHighlight();
  }
});
// 音轨tab和卡片动态渲染
const tracks = [
  {
    name: '音轨1',
    channelName: 'channel1',
    freqName: 'freq1',
    mainId: 'main1',
  },
  {
    name: '音轨2',
    channelName: 'channel2',
    freqName: 'freq2',
    mainId: 'main2',
  },
  {
    name: '音轨3',
    channelName: 'channel2',
    freqName: 'freq3',
    mainId: 'main3',
  },
];
let currentTrack = 0;

function renderTrackTabs() {
  const tabBar = document.getElementById('track-tabs');
  tabBar.innerHTML = '';
  tracks.forEach((track, idx) => {
    const tab = document.createElement('button');
    tab.className = 'track-tab' + (idx === currentTrack ? ' active' : '');
    tab.innerHTML = `<i class='fas fa-music'></i> ${track.name}`;
    tab.onclick = () => {
      currentTrack = idx;
      renderTrackTabs();
      renderTrackCards();
      // 延迟更新箭头位置，确保DOM完全渲染后再计算位置
      setTimeout(updateArrowPosition, 50);
    };
    tabBar.appendChild(tab);
  });
}

function updateArrowPosition() {
  const activeTab = document.querySelector('.track-tab.active');
  const activeCard = document.querySelector('.track-card.active');
  
  if (activeTab && activeCard) {
    const tabRect = activeTab.getBoundingClientRect();
    const cardRect = activeCard.getBoundingClientRect();
    
    // 计算tab的中心位置相对于卡片的位置
    const tabCenter = tabRect.left + tabRect.width / 2;
    const cardLeft = cardRect.left;
    const arrowLeft = tabCenter - cardLeft;
    
    // 设置小箭头的位置，确保有动画效果
    activeCard.style.setProperty('--arrow-left', arrowLeft + 'px');
    
    // 强制触发重绘以确保动画生效
    activeCard.offsetHeight;
  }
}

function renderTrackCards() {
  const list = document.getElementById('track-list');
  list.innerHTML = '';
  const track = tracks[currentTrack];
  // 只渲染当前音轨卡片
  const card = document.createElement('div');
  card.className = 'track-card active';
  card.innerHTML = `
    <div class="flex items-center track-header">
      <span class="track-title flex-1">${track.name}</span>
      <button class="delete-btn flex items-center"><i class="fas fa-trash"></i> 删除</button>
    </div>
    <div class="flex flex-wrap track-controls mb-1">
      <div>
        <div class="text-xs text-gray-500 mb-1">声道</div>
        <div class="radio-group flex">
          <label><input type="radio" name="${track.channelName}" value="center" checked><span>居中</span></label>
          <label><input type="radio" name="${track.channelName}" value="left"><span>居左</span></label>
          <label><input type="radio" name="${track.channelName}" value="right"><span>居右</span></label>
        </div>
      </div>
      <div>
        <div class="text-xs text-gray-500 mb-1">突出频率</div>
        <div class="radio-group flex">
          <label><input type="radio" name="${track.freqName}" value="auto" checked><span>智能</span></label>
          <label><input type="radio" name="${track.freqName}" value="high"><span>高频</span></label>
          <label><input type="radio" name="${track.freqName}" value="mid"><span>中频</span></label>
          <label><input type="radio" name="${track.freqName}" value="low"><span>低频</span></label>
        </div>
      </div>
      <div class="main-track-row">
        <span class="main-track-label">作为主音轨</span>
        <label class="switch">
          <input type="checkbox" id="${track.mainId}">
          <span class="slider"></span>
        </label>
      </div>
    </div>
    <div class="flex items-center justify-center mt-1 mb-0">
      <button class="play-btn bg-blue-500 hover:bg-blue-600 text-white rounded-full px-6 py-2 flex items-center gap-2 shadow">
        <i class="fas fa-play"></i> <span>播放</span>
      </button>
      <audio class="audio-player" src=""></audio>
    </div>
  `;
  list.appendChild(card);
  // 播放按钮逻辑
  const playBtn = card.querySelector('.play-btn');
  const audio = card.querySelector('.audio-player');
  let playing = false;
  playBtn.onclick = function() {
    if (!playing) {
      audio.play();
      playBtn.querySelector('i').className = 'fas fa-pause';
      playBtn.querySelector('span').textContent = '暂停';
      playing = true;
    } else {
      audio.pause();
      playBtn.querySelector('i').className = 'fas fa-play';
      playBtn.querySelector('span').textContent = '播放';
      playing = false;
    }
  };
  audio.onended = function() {
    playBtn.querySelector('i').className = 'fas fa-play';
    playBtn.querySelector('span').textContent = '播放';
    playing = false;
  };
  // 删除按钮逻辑
  const deleteBtn = card.querySelector('.delete-btn');
  deleteBtn.onclick = function() {
    tracks.splice(currentTrack, 1); // 删除当前音轨
    currentTrack = Math.min(currentTrack, tracks.length - 1); // 确保currentTrack不越界
    renderTrackTabs(); // 重新渲染音轨标签
    renderTrackCards(); // 重新渲染音轨卡片
    updateArrowPosition(); // 更新箭头位置
  };
  updateRadioGroupHighlight();
  // 延迟更新箭头位置，确保DOM已渲染
  setTimeout(updateArrowPosition, 50);
}
document.addEventListener('DOMContentLoaded', function() {
  renderTrackTabs();
  renderTrackCards();
  // 初始化时更新箭头位置
  setTimeout(updateArrowPosition, 100);
});
</script>
</html>